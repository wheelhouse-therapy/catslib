%% tnrs
<link rel='stylesheet' href='{{ CATSDIR_CSS }}tnrs.css'>

%% akaunting
<!-- Font Awesome -->
<link rel="stylesheet" href="{{ CATSDIR_AKAUNTING }}css/font-awesome.min.css">
<!-- AdminLTE Skins -->
<link rel="stylesheet" href="http://localhost:8080/akaunting/vendor/almasaeed2010/adminlte/dist/css/skins/skin-green-light.min.css">
<!-- Select2 -->
<link rel="stylesheet" href="http://localhost:8080/akaunting/vendor/almasaeed2010/adminlte/plugins/select2/select2.min.css">
<!-- App style -->
<link rel="stylesheet" href="{{ CATSDIR_AKAUNTING }}css/app.css?v=1.3.17">
<link rel="stylesheet" href="{{ CATSDIR_AKAUNTING }}css/akaunting-green.css?v=1.3.17">

<link rel="stylesheet" href="http://localhost:8080/akaunting/vendor/almasaeed2010/adminlte/plugins/datepicker/datepicker3.css">


<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
<!-- Select2 -->
<script src="http://localhost:8080/akaunting/vendor/almasaeed2010/adminlte/plugins/select2/select2.min.js"></script>
<!-- Mask Money -->
<script src="{{ CATSDIR_AKAUNTING }}js/jquery/jquery.maskMoney.js"></script>

<script src="{{ CATSDIR_AKAUNTING }}js/app.js?v=1.3.17"></script>
<script src="http://localhost:8080/akaunting/vendor/almasaeed2010/adminlte/plugins/datepicker/bootstrap-datepicker.js"></script>
<script src="http://localhost:8080/akaunting/vendor/almasaeed2010/adminlte/plugins/datepicker/locales/bootstrap-datepicker.en.js"></script>
<script type="text/javascript">
    var item_row = '1';
    function totalItem() {
        $('.box-footer .btn-success').prop('disabled', true);
        var ra = [];
        document.querySelectorAll("input[id^=item-debit-]").forEach(a => ra.push($(a).maskMoney('unmasked')[0]));
        var debit = ra.reduce((a,b) => Number(a)+Number(b));

        var ra = [];
        document.querySelectorAll("input[id^=item-credit-]").forEach(a => ra.push($(a).maskMoney('unmasked')[0]));
        var credit = ra.reduce((a,b) => Number(a)+Number(b));
        
        $('#debit-sub-total').html(debit);
        $('#credit-sub-total').html(credit);
        $('#debit-grand-total').html(debit);
    	$('#credit-grand-total').html(credit);
        if (debit == credit) {
            $('.box-footer .btn-success').prop('disabled', false);
            $('#debit-grand-total').parent().css('background-color', '#d0e9c6');
            $('#credit-grand-total').parent().css('background-color', '#d0e9c6');
        } else if (debit > credit) {
            $('#debit-grand-total').parent().css('background-color', '#d0e9c6');
            $('#credit-grand-total').parent().css('background-color', '#f2dede');
        } else if (debit < credit) {
            $('#debit-grand-total').parent().css('background-color', '#f2dede');
            $('#credit-grand-total').parent().css('background-color', '#d0e9c6');
        }
    }
    $(document).on('click', '#button-add-item', function (e) {
        			var clone = document.getElementById('tableRow').content.cloneNode(true);
        			clone.querySelectorAll('[id="item-debit-"]')[0].id = "item-debit-" + item_row;
        			clone.querySelectorAll('[id="item-credit-"]')[0].id = "item-credit-" + item_row;
                    $('#items tbody #addItem').before(clone);

                    $('[data-toggle="tooltip"]').tooltip('hide');
debugger;
                    $("#item-debit-" + item_row).maskMoney({
                        thousands : ',',
                        decimal : '.',
                        precision : 2,
                        allowZero : true,
                        prefix : '$',
                        suffix : ''
                    });

                    $("#item-debit-" + item_row).trigger('focusout');

                    $("#item-credit-" + item_row).maskMoney({
                    	thousands : ',',
                        decimal : '.',
                        precision : 2,
                        allowZero : true,
                        prefix : '$',
                        suffix : ''
                    });

                    $("#item-credit-" + item_row).trigger('focusout');

                    $(".input-account").select2({
                        placeholder: {
                            id: '-1', // the value of the option
                            text: "- Select Account -"
                        }
                    });

                    item_row++;
    });

    $(document).on('change', '.input-price', function(){
        alert('onChange');
        id = $(this).attr('id');
debugger;
        ids = id.split('-');

        amount = $(this).maskMoney('unmasked')[0];

        $(this).parent().removeClass('has-error');
        $(this).parent().find('.help-block').remove();

        if (ids[1] == 'debit') {
            $('#item-credit-' + ids[2]).prop('disabled', true);

            $('#item-credit-' + ids[2]).parent().removeClass('has-error');
            $('#item-credit-' + ids[2]).parent().find('.help-block').remove();
        } else {
            $('#item-debit-' + ids[2]).prop('disabled', true);

            $('#item-debit-' + ids[2]).parent().removeClass('has-error');
            $('#item-debit-' + ids[2]).parent().find('.help-block').remove();
        }

        if (amount == 0) {
            $('#item-debit-' + ids[2]).prop('disabled', false);
            $('#item-credit-' + ids[2]).prop('disabled', false);
        }
    });

    var focus = false;

    $(document).on('focusin', '#items .input-price', function(){
        focus = true;
    });

    $(document).on('blur', '#items .input-price', function(){
        if (focus) {
            totalItem();

            focus = false;
        }
    });

    $(document).ready(function(){
        $('.box-footer .btn-success').prop('disabled', true);

        
        $(".input-price").maskMoney({
            thousands : ',',
            decimal : '.',
            precision : 2,
            allowZero : true,
                        prefix : '$'
                    });

        $('.input-price').trigger('focusout');

        $(".input-account").select2({
            placeholder: {
                id: '-1', // the value of the option
                text: "- Select Account -"
            }
        });

        //Date picker
        $('#paid_at').datepicker({
            format: 'yyyy-mm-dd',
            todayBtn: 'linked',
            autoclose: true,
            language: 'en'
        });

        $("#debit_account_id").select2({
            placeholder: "- Select Account -"
        });

        $("#credit_account_id").select2({
            placeholder: "- Select Account -"
        });
    });
</script>